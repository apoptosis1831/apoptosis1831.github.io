---
layout: post
title: STUDY-Node.js(이론)
subtitle: Node.js개념과 동작원리
categories: study
tags: [Node.js]




---



## STUDY-Node.js(이론)

### Node.js란? 자바스크립트의 런타임!

흔히들 Node.js 가 서버나 프레임워크라고 착각하는데 Node.js는 **자바스크립트의 런타임**이다.

(여기서 **런타임**이란? 자바스크립트로 짜진 코드를 돌려주는 환경이다.)

Node.js는 웹브라우저 밖에서 우리가 작성할 자바스크립트 서버 코드를 실행해주는 환경이다. 이는 브라우저에서 돌릴 수 있는 자바스크립트 코드를 우리의 컴퓨터에서 돌릴 수 있도록 밖으로 빼놓았다는 것을 의미한다.

(여기서 **프레임워크**란? 애플리케이션 개발에 바탕이 되는 템플릿과 같은 역할을 하는 클래스와 인터페이스의 집합이다. 보편적인 프레임워크로는 파이썬을 사용하는 Django, 자바를 사용하는 Sping이 있다.)



### Node.js가 동작하는 방식

Node.js는 **비동기 방식**으로 동작하여 데이터 처리 속도가 빠르다. 비동기 방식은 여러 작업을 한번에 처리하는 방법이다.

그렇다면 어떻게 여러 작업을 처리 할 수 있는 것인가?

이는 Node.js가 응답을 기다리지 않고 바로 다음 작업을 실행하는 **논블로킹/비동기방식**을 사용하기 떄문이다.

또한 Node.js는 **싱글 스레드**와 **이벤트 루프**를 기반으로 한다.

Node.js는 작업이 종료되면 이벤트를 발생시키고 이를 **콜백 큐(작업 큐)**에 등록한다. 응답을 기다리는 대신 다른 작업을 먼저 수행한다. 작업이 완료 되는 것은 **이벤트 루프**를 통해 알 수 있다. 이벤트 루프는 지속적으로 콜 스택이 비어있는지 체크한다. **콜 스택**이 비었으면 콜백 큐의 작업을 콜 스택으로 밀어 넣는다.

> 콜백 큐 : 이벤트 발생 후 호출되어야 할 작업을 기다리는 자료구조. 이벤트 큐라고도 함.
>
> 콜 스택 : 함수의 호출을 기록하는 자료구조. 현재 실행중인 작업이 끝났을 때 어느 실행 부분으로 돌아갈지 보관함.



### Node.js 동작과정 정리

동작하는 과정을 정리해보면 아래와 같다.

1. `이벤트 루프`는 일종의 감시자이다. 어떤 이벤트가 있는지 계속 감시하고, 이벤트가 감지되면 그 작업을 위해 작업 스레드를 생성한다.
2. `작업 스레드`는 일종의 작업공간 같은 것이다. 이벤트를 처리하기 위해 이벤트 루프는 처리 작업을 작업 스레드에게 맡겨버리고 다른 이벤트가 없나 다시 감시를 시작한다.
3. 작업 스레드가 작업을 받을 때, `콜백 함수`라는 것을 받는데 이는 작업이 끝나면 실행하는 함수이다.
4. 작업 스레드는 작업을 마치면 이 콜백 함수를 실행하고 싶다고 최고 감시자인 이벤트 루프에게 응답을 보낸다.
5. 응답을 받은 이벤트 루프는 콜백 함수의 결과를 클라이언트에 전송하여 우리가 볼 수 있는 결과로 바꾸어 준다.